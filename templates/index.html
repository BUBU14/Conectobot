<!DOCTYPE html>

<!--suppress ALL -->
<html xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>LuxNett Control robot</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">
    <script defer src="https://use.fontawesome.com/releases/v5.0.0/js/all.js"></script>
    <script src="http://code.jquery.com/jquery-3.3.1.min.js" crossorigin="anonymous"></script>

</head>
<body>
<section class="section">
    <div class="container">
        <div class="columns">
            <div class="column" align="center">
                MODE
                <div class="columns">
                    <div class="column">
                        <a class="button is-info is-medium is-outlined is-centered">Teach</a>
                        <div class="ul">
                            <div class="li">
                                <p>ACTION</p>
                                <a class="button is-rounded is-warning" id="water" value="Stop" onclick="statusWater()">Water</a>
                                <a class="button is-rounded is-warning" id="brush" value="Stop" onclick="statusBrush()">Brush</a>
                            </div>
                            <div class="li">
                                <p>COMMANDE</p>
                                <a title="left" class="button is-outlined" id="left" onclick="moveLeft()">
                                    <span class="icon">
                                        <i class="fa fa-chevron-left"></i>
                                    </span>
                                </a>
                                <a title="up" class="button is-outlined" id="up" onmousedown="moveUp()" onmouseup="mouseMoveUp()">
                                    <span class="icon">
                                        <i class="fa fa-chevron-up"></i>
                                    </span>
                                </a>
                                <a title="down" class="button is-outlined" id="down" onclick="moveDown()">
                                    <span class="icon">
                                        <i class="fa fa-chevron-down"></i>
                                    </span>
                                </a>
                                <a title="right" class="button is-outlined" id="right" onclick="moveRight()">
                                    <span class="icon">
                                        <i class="fa fa-chevron-right"></i>
                                    </span>
                                </a>
                            </div>
                            <div class="li">
                                CONTROL PANEL

                            </div>
                        </div>
                    </div>
                    <div class="column">
                        <a class="button is-info is-medium is-outlined is-centered">Automatic</a>
                        </br>
                        </br>
                        Height<input class=" input is-warning" type="text" placeholder="Height"/>
                        Width <input class=" input is-warning" type="text" placeholder="Width"/>
                        Angle <input class=" input is-warning" type="text" placeholder="Angle"/>
                        Speed <input class=" input is-warning" type="text" placeholder="Speed"/>
                        </br>
                        </br>
                        <a class="button is-success is-rounded is-right">Start Automatic</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<script>

    function statusBrush() {
        var elem = document.getElementById("brush");
        var state ;
        var jsonToSend = new Object();

        if (elem.value =="Stop")
        {
            state = 1 ;
        }
        else
        {
            state = 0 ;
        }
        jsonToSend.state = state;
        var jsonString = JSON.stringify(jsonToSend, null, '\t');
        $.ajax({
            url: '/brush/',
            type: 'POST',
            dataType: 'application/json;charset=UTF-8',
            data: jsonString,
            statusCode: {
                200: function () {
                    if (elem.value == "Stop") {
                        elem.value = "Start";
                        elem.classList.remove("is-warning");
                        elem.classList.add("is-success");
                        console.log("I'm starting brush");
                    }
                    else {
                        elem.value = "Stop";
                        elem.classList.remove("is-success");
                        elem.classList.add("is-warning");
                        console.log("I'm ending brush");
                    }
                    console.log("Success !");
                },
                400: function () {
                    console.log("Couldn't change state of Brush")
                    if (state == 0) {
                        state = 1;
                    }
                    else {
                        state = 0;
                    }
                }
            }
        });
    }

    function statusWater() {
        var elem = document.getElementById("water");
        var state ;
        var jsonToSend = new Object();

        if (elem.value =="Stop")
        {
            state = 1 ;
        }
        else
        {
            state = 0 ;
        }
        jsonToSend.state = state;
        var jsonString = JSON.stringify(jsonToSend, null, '\t');
        $.ajax({
            url: '/water/',
            type: 'POST',
            dataType: 'application/json;charset=UTF-8',
            data: jsonString,
            statusCode: {
                200: function () {
                    if (elem.value == "Stop") {
                        elem.value = "Start";
                        elem.classList.remove("is-warning");
                        elem.classList.add("is-success");
                        console.log("I'm starting water");
                    }
                    else {
                        elem.value = "Stop";
                        elem.classList.remove("is-success");
                        elem.classList.add("is-warning");
                        console.log("I'm ending water");
                    }
                    console.log("Success !");
                },
                400: function () {
                    console.log("Couldn't change state of Water")
                    if (state == 0) {
                        state = 1;
                    }
                    else {
                        state = 0;
                    }
                }
            }
        });
    }
    var mousedownID = -1 ;
    function moveUp()
    {
        if(mousedownID==-1)  //Prevent multimple loops!
            mousedownID = setInterval(sendUp, 100);
    }
    function mouseMoveUp() {
        if(mousedownID!=-1) {  //Only stop if exists
            clearInterval(mousedownID);
            mousedownID=-1;
        }
    }
    function sendUp() {
        var jsonToSend = new Object();
        jsonToSend.up = 1;
        var jsonString = JSON.stringify(jsonToSend, null, '\t');
        $.ajax({
            url: '/up/',
            type: 'POST',
            dataType: 'application/json;charset=UTF-8',
            data: jsonString,
            statusCode: {
                200: function () {
                    console.log("i move up !");
                },
                400: function () {
                    console.log("Couldn't move up");
                }
            }
        });
    }

    function moveDown()
    {
        console.log("I'm move down");
    }

    function moveLeft()
    {
        console.log("I'm move left");
    }

    function moveRight()
    {
        console.log("I'm move right");
    }
    function generalMove()
    {
        console.log("data from CONTROL PANEL : X and Y ")
    }

</script>

</body>
</html>